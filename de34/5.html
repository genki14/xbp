<!DOCTYPE html>
<html lang="jp">
<head>
    <!-- ⑥↓タイトルを変えてみよう -->
    <title>XBP～開け夢の扉～</title>
    <!-- ⑤スタイルシートの設定をしよう -->
    <link rel="stylesheet" href="css/style.css">
    <!-- h1.htmlからある行をコピペしてくればOK -->
</head>
<body>
    <h1>第14回(最終プロジェクト発表）</h1>
    <!-- 塊ごとにdivタグで区切るようにしましょう。 -->
<div style="text-align: left;">
         <!-- ①↓に文字を書いてみよう -->
    <h2>■第7班最終プロジェクト発表</h2>
         <h3 style="text-align:left;"><a href="https://www.youtube.com/watch?v=jhLbuFFNNMk">最終プロジェクト発表動画　YouTube</a></h3>


　　<h2>■製品の概要</h2>
<div>
・最終的に作ったもの：「音がなるキースタンド」<br>
<br>
・仕組み：キースタンドに鍵を指すと写真立ての裏にあるスピーカーからファミマの音声が流れる。<br>
<br>
・ねらい：一人ぐらいの寂しさを解消する。（一人暮らしを明るくする）<br>
<br>
・プレゼンの資料：<a href="files/デザイン演習発表.pdf" target="_blank">最終プロジェクトPP</a><br>
<br>
＜完成図＞<br>
<img src="images/keystand.jpg" width="40%"><br>



<h2>●キースタンド</h2>
<h3 style="text-align: left;">・Arudinoのソースコード（ファミマの音声）</h3>
<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">int val=0;</li>
    <li style="background-color:#EEF;">int from_pc=<font style="color:brown;">'0'</font>;</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">#define BEATTIME 310 </li>
    <li style="background-color:#EFF;">#define PIN 11 </li>
    <li style="background-color:#EEF;">&nbsp;</li>
    <li style="background-color:#EFF;">#define LA 880</li>
    <li style="background-color:#EEF;">#define FA 740</li>
    <li style="background-color:#EFF;">#define MI 659</li>
    <li style="background-color:#EEF;">#define RE 587</li>
    <li style="background-color:#EFF;">#define DLA 440</li>
    <li style="background-color:#EEF;">void setup() {</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;pinMode(11,OUTPUT);</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;Serial.begin(9600);</li>
    <li style="background-color:#EFF;">}</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">void loop(){</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;if(Serial.available() &gt; 0){</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;from_pc = Serial.read();</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;}</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;//１が送られてきたら音声が鳴る、0だったら鳴らない</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;if (from_pc==<font style="color:brown;">'1'</font>){</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;pinMode(11,HIGH);</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ファ#レラレミララミファ#ミラレ</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,FA,BEATTIME) ; // ファ#</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,RE,BEATTIME) ; // レ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,DLA,BEATTIME) ; // dラ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,RE,BEATTIME) ; // レ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,MI,BEATTIME) ; // ミ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,LA,BEATTIME) ; // ラ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME*2) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,DLA,BEATTIME) ; // dラ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,MI,BEATTIME) ; // ミ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,FA,BEATTIME) ; // ファ#</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,MI,BEATTIME) ; // ミ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,DLA,BEATTIME) ; // dラ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;tone(PIN,RE,BEATTIME) ; // レ</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;delay(BEATTIME) ;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;// exit the loop </li>
    <li style="background-color:#EFF;">exit(0);  //0 is required to prevent error.</li>
    <li style="background-color:#EEF;">}</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;else if (from_pc==<font style="color:brown;">'0'</font>){</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;pinMode(11,LOW);</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;}</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">delay(5000);</li>
    <li style="background-color:#EFF;">}</li>
    </ol></code>

<h3 style="text-align: left;">・Pythonのソースコード(ファミマの音声）</h3>
<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">import doyolab</li>
    <li style="background-color:#EEF;">import time</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">#シリアルポートを入力-------------------------</li>
    <li style="background-color:#EEF;">serial_port=<font style="color:brown;">'COM4'</font></li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">#Arduinoとのシリアル通信設定-------------------</li>
    <li style="background-color:#EEF;">my_arduino = doyolab.set_serial(serial_port,9600)</li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">#user_key、sub_idの設定---------------------</li>
    <li style="background-color:#EFF;">#自分のユーザーkeyを書く</li>
    <li style="background-color:#EEF;">user_key=</li>
    <li style="background-color:#EFF;">#subIDはどのデバイスからのデータか、どのプロジェクトのデータかなどを認識するために使います</li>
    <li style="background-color:#EEF;">sub_id=<font style="color:brown;">'pc'</font></li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"># --------------------------------------------------------------</li>
    <li style="background-color:#EEF;">while True:</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# IoTサーバーからデータの取得----------------------------------------------------</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# user_key</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# sub_id</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# データ数：最新のデータからいくつのデータを取得するか？下記の例では1(最新のデータのみ）</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;data_list = doyolab.getData_From_doyolabIoTserver(user_key, sub_id, 1)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# リスト形式で取得される</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;print(data_list)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;#0番目のデータの塊の中の2番目のデータを読みたい（0から始まるので、本当は3番目)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int_data =int(data_list[0][2])</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;print(int_data)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# --------------------------------------------------------------</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# int_dataが400より大きかったら、<font style="color:brown;">'1'</font>を送信(音声を鳴らせる）、それ以外の時は<font style="color:brown;">'0'</font>を送る(音声を鳴らせない）</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;if int_data&gt;400:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_arduino = <font style="color:brown;">'1'</font></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_arduino = <font style="color:brown;">'0'</font></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;#Arduinoにデータを送る</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;my_arduino.write(to_arduino.encode())</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(5)#指定した秒数を待つ（msでなく秒なので、注意）　　サーバーに負荷がかかるので5より小さい値は設定しないでください。（実装する際は可能な限り大きな数字にしてください）</li>
    </ol></code>


<h2>●写真立て</h2>
<h3 style="text-align: left;">・Arudinoのソースコード（明るさセンサー）</h3>
<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">void setup() {</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;// put your setup code here, to run once:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;Serial.begin(9600);</li>
    <li style="background-color:#EEF;">}</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">void loop() {</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;// put your main code here, to run repeatedly:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;int val=0;</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;val=analogRead(1);</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;Serial.println(val);</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;delay(500);</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">}</li>
    </ol></code>

<h3 style="text-align: left;">・Pythonのソースコード（明るさセンサー）</h3>
<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">import doyolab</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">#シリアルポートを入力-------------------------</li>
    <li style="background-color:#EEF;">serial_port=<font style="color:brown;">'COM5'</font></li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">#Arduinoとのシリアル通信設定-------------------</li>
    <li style="background-color:#EEF;">my_arduino = doyolab.set_serial(serial_port,9600)</li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">#user_key、sub_idの設定---------------------</li>
    <li style="background-color:#EFF;">#自分のユーザーkeyを書く</li>
    <li style="background-color:#EEF;">user_key=</li>
    <li style="background-color:#EFF;">#subIDはどのデバイスからのデータか、どのプロジェクトのデータかなどを認識するために使います</li>
    <li style="background-color:#EEF;">sub_id=<font style="color:brown;">'pc'</font></li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">#while Trueは無限ループ#----------------------</li>
    <li style="background-color:#EEF;">while True:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# Arduinoからreadlineコマンドでデータを取得し、data_from_arduinoという変数に格納</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;data_from_arduino=my_arduino.readline()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;#stripコマンドで、data_from_arduinoの中の余計な文字を削除</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;#さらにintで文字で送られてきたデータをint型に変換</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;data=int(data_from_arduino.strip())</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;print(data)</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# データの設定--------------------------------</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;datetime_data = <font style="color:brown;">""</font></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int_data = data #Arduinoから受け取った値をここでint_dataにいれる</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;float_data = <font style="color:brown;">""</font></li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;txt_data = <font style="color:brown;">""</font></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# -------------------------------------------</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# データの送信---------------------------------</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# user_key</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# sub_id</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# 日付データ（空白にしてもサーバーで自動で日付を入れてくれる）:datetim_data</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# 整数データ:int_data</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# 実数データ(小数を含むデータ):float_data</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# テキストデータ:txt_data</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;ret = doyolab.sendData_To_doyolabIoTserver(user_key, sub_id, datetime_data, int_data, float_data, txt_data)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;print(ret)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# -------------------------------------------</li>
    <li style="background-color:#EFF;">#-------------------------------------------</li>
    </ol></code>




<h2>■感想</h2>
今回のプロジェクトでは当初制作を予定していた製品が作れなくて悔しかった。<br>
私たちが元々作ろうとしていたものは家族の「おかえり」という声が聞こえてくるというものであったが、音声ファイルを上手くプログラムに組み込むことが出来ず失敗してしまった。<br>
今の自分たちでは解決できなかったことがとても悔しかった。<br>
結果的にはこの失敗から製品の方向性を変えて製品を完成まで持っていけたのは良かったと思う。<br>
プロジェクトを進めていくうえで主となるプランだけでなく、第二、第三のプランを考えておくことで失敗しても臨機応変に対応できることが学べた。<br>
また、今回の最終プロジェクトではチームで一つのことを進めていくという難しさを痛感した。<br>
班員それぞれに意見や考えがあり、それをすり合わせて方向性を決めることに苦労した。<br>
実際、私たちの班は班の中で対立してしまった時期もあったが、話し合いを重ねていくことで方向性をすり合わせ、最終的には班としてまとまり一つの作品を作ることができた。<br>
チームとして一つのプロジェクトを進めていくにはチームメイトの考えや意見をすり合わせて方向性を同じにすることが大切であり、そうするためには話し合うことが大切だと感じた。<br>
この経験は将来、絶対に生きてくるものであり、このような経験をさせてくれた先生や班員には感謝しかない。<br>



</div>





</div>
<div style="text-align: right;">
    <a href="index.html">デザイン演習Ⅰ・Ⅱトップページ</a><br>
    <a href="../index.html">XBPトップページ</a><br>

</div>

         
                    
    </div>

</body>
</html>